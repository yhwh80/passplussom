<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pass Plus S.O.M. - Dashboard</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-blue-600 text-white p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="bg-white text-blue-600 p-2 rounded-lg font-bold">S.O.M.</div>
                <h1 class="text-xl font-bold">Pass Plus S.O.M.</h1>
            </div>
            <div class="hidden md:flex space-x-4">
                <button onclick="showPage('dashboard')" class="nav-btn active">Dashboard</button>
                <button onclick="showPage('pupils')" class="nav-btn">Pupils</button>
                <button onclick="showPage('lessons')" class="nav-btn">Lessons</button>
                <button onclick="showPage('skills')" class="nav-btn">Skills</button>
                <button onclick="showPage('payments')" class="nav-btn">Payments</button>
                <button onclick="showPage('settings')" class="nav-btn">Settings</button>
            </div>
            <div class="flex items-center space-x-3">
                <span id="instructor-name" class="hidden">Welcome, Instructor</span>
                <button onclick="logout()" class="bg-red-500 hover:bg-red-600 px-3 py-1 rounded text-sm">Logout</button>
            </div>
        </div>
    </nav>

    <!-- Dashboard Page -->
    <div id="dashboard" class="page">
        <div class="container mx-auto p-6">
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-gray-800">Instructor Dashboard</h2>
                <p class="text-gray-600">Welcome to your Pass Plus S.O.M. control center</p>
            </div>
            
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="stat-card bg-blue-500">
                    <div class="stat-icon">üë•</div>
                    <div>
                        <h3 class="stat-label">Active Pupils</h3>
                        <p class="stat-value" id="total-pupils">0</p>
                    </div>
                </div>
                <div class="stat-card bg-green-500">
                    <div class="stat-icon">üìÖ</div>
                    <div>
                        <h3 class="stat-label">This Week's Lessons</h3>
                        <p class="stat-value" id="active-lessons">0</p>
                    </div>
                </div>
                <div class="stat-card bg-purple-500">
                    <div class="stat-icon">üí∑</div>
                    <div>
                        <h3 class="stat-label">Total Revenue</h3>
                        <p class="stat-value" id="pending-payments">¬£0</p>
                    </div>
                </div>
                <div class="stat-card bg-orange-500">
                    <div class="stat-icon">üèÜ</div>
                    <div>
                        <h3 class="stat-label">Skills Completed</h3>
                        <p class="stat-value" id="skills-completed">0</p>
                    </div>
                </div>
            </div>

            <!-- Quick Actions & Recent Activity -->
            <div class="grid md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow">
                    <h3 class="text-lg font-bold mb-3 text-gray-800">Quick Actions</h3>
                    <div class="space-y-2">
                        <button onclick="showPage('pupils'); showAddPupilForm();" class="action-btn bg-blue-500 hover:bg-blue-600">
                            + Add New Pupil
                        </button>
                        <button onclick="showPage('lessons'); showAddLessonForm();" class="action-btn bg-green-500 hover:bg-green-600">
                            üìÖ Schedule Lesson
                        </button>
                        <button onclick="showPage('skills');" class="action-btn bg-purple-500 hover:bg-purple-600">
                            üìä Update Progress
                        </button>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-bold mb-3 text-gray-800">Upcoming Lessons</h3>
                    <div id="upcoming-lessons" class="space-y-3">
                        <div class="text-gray-500 text-center py-4">Loading...</div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-bold mb-3 text-gray-800">Recent Progress</h3>
                    <div id="recent-progress" class="space-y-3">
                        <div class="text-gray-500 text-center py-4">Loading...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pupils Page -->
    <div id="pupils" class="page hidden">
        <div class="container mx-auto p-6">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-3xl font-bold text-gray-800">Manage Pupils</h2>
                    <p class="text-gray-600">Add, edit, and track your driving pupils</p>
                </div>
                <button onclick="showAddPupilForm()" class="btn-primary">
                    + Add New Pupil
                </button>
            </div>

            <!-- Add Pupil Form -->
            <div id="add-pupil-form" class="form-container hidden mb-6">
                <h3 class="form-title">Add New Pupil</h3>
                <form onsubmit="addPupil(event)" class="pupil-form">
                    <div class="form-grid">
                        <input type="text" id="pupil-name" placeholder="Full Name" required class="form-input">
                        <input type="email" id="pupil-email" placeholder="Email Address" required class="form-input">
                        <input type="tel" id="pupil-phone" placeholder="Phone Number" required class="form-input">
                        <input type="date" id="pupil-dob" placeholder="Date of Birth" class="form-input">
                    </div>
                    <textarea id="pupil-address" placeholder="Home Address" class="form-input w-full mt-4" rows="3"></textarea>
                    <div class="form-actions">
                        <button type="submit" class="btn-success">Add Pupil</button>
                        <button type="button" onclick="hideAddPupilForm()" class="btn-secondary">Cancel</button>
                    </div>
                </form>
            </div>

            <!-- Pupils List -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="p-6 border-b">
                    <h3 class="text-xl font-bold text-gray-800">Your Pupils</h3>
                </div>
                <div id="pupils-list" class="divide-y">
                    <div class="p-6 text-center text-gray-500">Loading pupils...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lessons Page -->
    <div id="lessons" class="page hidden">
        <div class="container mx-auto p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold text-gray-800">Lesson Management</h2>
                <button onclick="showAddLessonForm()" class="btn-primary">Schedule Lesson</button>
            </div>
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-xl font-bold mb-4">This Week's Schedule</h3>
                <div id="lessons-calendar" class="space-y-4">
                    <p class="text-gray-500 text-center py-4">Lesson scheduling coming soon...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Skills Page -->
    <div id="skills" class="page hidden">
        <div class="container mx-auto p-6">
            <h2 class="text-3xl font-bold mb-6 text-gray-800">Pass Plus Skills Tracking</h2>
            <div class="bg-white rounded-lg shadow-md p-6">
                <div id="skills-progress" class="space-y-4">
                    <p class="text-gray-500 text-center py-4">Skills tracking coming soon...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Payments Page -->
    <div id="payments" class="page hidden">
        <div class="container mx-auto p-6">
            <h2 class="text-3xl font-bold mb-6 text-gray-800">Payment Management</h2>
            <div class="bg-white rounded-lg shadow-md p-6">
                <div id="payments-list" class="space-y-4">
                    <p class="text-gray-500 text-center py-4">Payment management coming soon...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Page -->
    <div id="settings" class="page hidden">
        <div class="container mx-auto p-6">
            <h2 class="text-3xl font-bold mb-6 text-gray-800">Instructor Settings</h2>
            <div class="bg-white rounded-lg shadow-md p-6">
                <form id="instructor-settings-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="full-name">Full Name</label>
                            <input type="text" id="full-name" name="full_name" required class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email-settings" name="email" required class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone</label>
                            <input type="tel" id="phone-settings" name="phone" class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="hourly-rate">Hourly Rate (¬£)</label>
                            <input type="number" id="hourly-rate" name="hourly_rate" step="0.01" min="0" class="form-input">
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Save Settings</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/supabase.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/app.js"></script>
    <script type="module" src="js/dashboard.js"></script>
    <script type="module" src="js/pupils.js"></script>
    <script type="module" src="js/utils.js"></script>
</body>
</html>